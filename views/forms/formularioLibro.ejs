<!-- Formulario -->
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card shadow">
                <div class="card-header bg-info text-white">
                    <h2 class="h4 mb-0 text-center">
                        <i class="bi bi-book me-2"></i>
                        <%= libro ? 'Actualizar Libro' : 'Agregar Nuevo Libro' %>
                    </h2>
                </div>
                <% if (success_msg && success_msg.length > 0) { %>
                    <div class="alert alert-success alert-dismissible fade show" role="alert">
                      <%= success_msg %>
                      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                  <% } %>
                <div class="card-body">
                    <form action="<%= libro ? '/libros/' + libro.id + '?_method=PUT' : '/libros' %>" method="POST" enctype="application/x-www-form-urlencoded">
                        <!-- Campo Título -->
                        <div class="mb-3">
                            <label for="titulo" class="form-label fw-bold">Título </label>
                            <input 
                                type="text" 
                                class="form-control form-control-lg" 
                                id="titulo" 
                                name="titulo"
                                placeholder="Ej: Cien años de soledad"
                                value="<%= libro ? libro.titulo : '' %>"
                                required
                            >
                            <div class="invalid-feedback">
                                Por favor ingresa el título del libro
                            </div>
                        </div>

                        <!-- Campo Autor -->
                        <div class="mb-3">
                            <label for="autor" class="form-label fw-bold">Autor </label>
                            <input 
                                type="text" 
                                class="form-control form-control-lg" 
                                id="autor" 
                                name="autor"
                                placeholder="Ej: Gabriel García Márquez"
                                value="<%= libro ? libro.autor : '' %>"
                                required
                            >
                            <div class="invalid-feedback">
                                Por favor ingresa el autor del libro
                            </div>
                        </div>

                        <!-- Campo ISBN (Opcional) -->
                        <div class="mb-3">
                            <label for="anio_publicacion" class="form-label">Año de publicacion</label>
                            <input 
                                type="text" 
                                class="form-control" 
                                id="anio_publicacion" 
                                name="anio_publicacion"
                                placeholder="1918"
                                value="<%= libro ? libro.anio_publicacion : '' %>"
                            >
                        </div>

                        <!-- Selector de Género -->
                        <div class="mb-4">
                            <label for="genero" class="form-label fw-bold">Género</label>
                            <input
                               type = "text"
                               class="form-control" 
                               id="genero" 
                               name="genero"
                               placeholder="Novela"
                               value="<%= libro ? libro.genero : '' %>"
                            >
                        </div>

                        <!-- Botones de acción -->
                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <a href="/libros" class="btn btn-outline-secondary me-md-2">
                                <i class="bi bi-arrow-left me-1"></i> Cancelar
                            </a>
                            <button type="submit" class="btn btn-info">
                                <i class="bi <%= libro ? 'bi-pencil-square' : 'bi-save' %> me-1"></i>
                                <%= libro ? 'Actualizar Libro' : 'Guardar Libro' %>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    setTimeout(() => {
        const alerts = document.querySelectorAll('.alert');
        alerts.forEach(alert => {
            alert.classList.remove('show');
            alert.classList.add('fade');
            setTimeout(() => alert.remove(), 5000);
        });
    }, 3000);
</script>